import{a as ie,b as re}from"./chunk-HGHWDJ3Y.js";import{a as X}from"./chunk-GX2D2L2X.js";import{c as k,f as J,m as K,p as O,q as Q,r as U}from"./chunk-FGBSBVHW.js";import"./chunk-5R36QA5Q.js";import{a as Y,b as Z,c as $,d as ee,f as te,h as ne}from"./chunk-SJZ6P2DA.js";import"./chunk-SKMC2KSJ.js";import{R as F,S as P,U as L,Z as V,fa as A,ha as j,pa as z,qa as G,ta as H}from"./chunk-YMB734HE.js";import{r as W,s as B}from"./chunk-Q6UYEA4T.js";import{$b as q,Bb as E,Bc as a,Dc as p,Ec as D,Ga as c,Gc as S,Hc as b,Ic as _,Sb as f,Tb as M,Tc as I,Vc as N,Yb as h,Zb as i,_b as t,kc as w,lb as s,ma as R,mc as C,v as x}from"./chunk-ZXFVGPYG.js";import"./chunk-RNQFGQA5.js";function me(l,u){if(l&1&&(q(0,"mat-progress-bar",8),i(1,"p"),a(2),t()),l&2){let n=C();h("value",n.progress()),s(2),D("Progress: ",n.completed()," / ",n.totalRequests)}}function pe(l,u){if(l&1&&(i(0,"div",7)(1,"h3",9),a(2,"Results"),t(),i(3,"p"),a(4),t(),i(5,"p"),a(6),t(),i(7,"p"),a(8),t(),i(9,"p"),a(10),I(11,"number"),t()()),l&2){let n,e,o,r,d=C();s(4),p("Time Taken: ",(n=d.results())==null?null:n.timeTaken,"ms"),s(2),p("Requests/Sec: ",(e=d.results())==null?null:e.rps),s(2),p("Errors: ",(o=d.results())==null?null:o.errors),s(2),p("Avg Latency: ",N(11,4,(r=d.results())==null?null:r.avgLatency,"1.0-2"),"ms")}}var se=class l{apiWrapper=R(k);concurrency=10;totalRequests=100;isRunning=c(!1);progress=c(0);completed=c(0);results=c(null);async startTest(){this.isRunning.set(!0),this.completed.set(0),this.progress.set(0),this.results.set(null);let u=Date.now(),n=0,e=[],o=this.concurrency,r=Math.ceil(this.totalRequests/o);for(let m=0;m<r;m++){let g=[],oe=Math.min(o,this.totalRequests-m*o);for(let y=0;y<oe;y++){let le=Date.now();g.push(x(this.apiWrapper.wrap(X.getMultiApiV1MachinesGet())).then(()=>{e.push(Date.now()-le)}).catch(()=>{n++}))}await Promise.all(g);let T=Math.min((m+1)*o,this.totalRequests);this.completed.set(T),this.progress.set(T/this.totalRequests*100)}let v=Date.now()-u,ae=e.reduce((m,g)=>m+g,0)/e.length||0;this.results.set({timeTaken:v,rps:this.totalRequests/(v/1e3),errors:n,avgLatency:ae}),this.isRunning.set(!1)}static \u0275fac=function(n){return new(n||l)};static \u0275cmp=E({type:l,selectors:[["app-stress-test"]],decls:22,vars:6,consts:[[1,"container","p-4"],[1,"flex","flex-col","gap-4","mt-4"],[1,"flex","gap-4"],["matInput","","type","number","min","1","max","100",3,"ngModelChange","ngModel"],["matInput","","type","number","min","1","max","10000",3,"ngModelChange","ngModel"],[1,"actions"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"results","mt-4","p-4","bg-gray-100","rounded"],["mode","determinate",3,"value"],[1,"font-bold"]],template:function(n,e){n&1&&(i(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),a(4,"Frontend Stress Tester"),t(),i(5,"mat-card-subtitle"),a(6,"Generate load from the browser"),t()(),i(7,"mat-card-content",1)(8,"div",2)(9,"mat-form-field")(10,"mat-label"),a(11,"Concurrent Requests"),t(),i(12,"input",3),_("ngModelChange",function(r){return b(e.concurrency,r)||(e.concurrency=r),r}),t()(),i(13,"mat-form-field")(14,"mat-label"),a(15,"Total Requests"),t(),i(16,"input",4),_("ngModelChange",function(r){return b(e.totalRequests,r)||(e.totalRequests=r),r}),t()()(),i(17,"div",5)(18,"button",6),w("click",function(){return e.startTest()}),a(19),t()(),f(20,me,3,3),f(21,pe,12,7,"div",7),t()()()),n&2&&(s(12),S("ngModel",e.concurrency),s(4),S("ngModel",e.totalRequests),s(2),h("disabled",e.isRunning()),s(),p(" ",e.isRunning()?"Running...":"Start Stress Test"," "),s(),M(e.isRunning()?20:-1),s(),M(e.results()?21:-1))},dependencies:[B,P,F,ne,Y,$,te,ee,Z,O,K,J,U,Q,re,ie,H,L,j,V,G,z,A,W],encapsulation:2})};export{se as StressTestComponent};
