
[1m[46m RUN [49m[22m [36mv4.0.15 [39m[90m/Users/mar/Projects/pylabpraxis/praxis/web-client[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould initialize from prebuilt database if available
[22m[39m[SqliteService] Loaded prebuilt database with PLR definitions

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould initialize from prebuilt database if available
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould initialize from prebuilt database if available
[22m[39m[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould initialize from prebuilt database if available
[22m[39m[SqliteService] Loaded prebuilt database with PLR definitions

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould initialize from prebuilt database if available
[22m[39m[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould initialize from prebuilt database if available
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould fall back to legacy if both prebuilt and schema fail
[22m[39m[SqliteService] Prebuilt database not available

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould fall back to legacy if both prebuilt and schema fail
[22m[39m[SqliteService] schema.sql not available

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould fall back to legacy if both prebuilt and schema fail
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould fall back to legacy if both prebuilt and schema fail
[22m[39m[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould load from IndexedDB persistence if available
[22m[39m[SqliteService] Loaded database from IndexedDB persistence
[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould load from IndexedDB persistence if available
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould save to IndexedDB on request
[22m[39m[SqliteService] Loaded prebuilt database with PLR definitions

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould save to IndexedDB on request
[22m[39m[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould save to IndexedDB on request
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould clear store on clearStore
[22m[39m[SqliteService] Loaded prebuilt database with PLR definitions

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould clear store on clearStore
[22m[39m[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould clear store on clearStore
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould create a machine and persist
[22m[39m[SqliteService] Loaded prebuilt database with PLR definitions

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould create a machine and persist
[22m[39m[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould create a machine and persist
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould create a machine and persist
[22m[39m[SqliteService] Failed to create machine: TypeError: defQuery.bind is not a function
    at [90m/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:665:34
    at [90m/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/operators/map.js:10:37
    at OperatorSubscriber._this._next [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/operators/OperatorSubscriber.js:33:21[90m)[39m
    at OperatorSubscriber.Subscriber.next [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/Subscriber.js:51:18[90m)[39m
    at [90m/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/Subject.js:69:34
    at Object.errorContext [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/util/errorContext.js:22:9[90m)[39m
    at ReplaySubject.Subject.next [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/Subject.js:59:24[90m)[39m
    at ReplaySubject.next [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/ReplaySubject.js:45:31[90m)[39m
    at Object.next [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/operators/share.js:69:58[90m)[39m
    at ConsumerObserver.next [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39mnode_modules/[4mrxjs[24m/dist/cjs/internal/Subscriber.js:113:33[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould list protocols from both new and legacy tables
[22m[39m[SqliteService] Loaded prebuilt database with PLR definitions

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould list protocols from both new and legacy tables
[22m[39m[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould list protocols from both new and legacy tables
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould get protocol simulation data
[22m[39m[SqliteService] Loaded prebuilt database with PLR definitions

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould get protocol simulation data
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould get protocol simulation data
[22m[39m[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould export database to file
[22m[39m[SqliteService] Loaded prebuilt database with PLR definitions

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould export database to file
[22m[39m[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould export database to file
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Could not load prebuilt database, trying schema.sql

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[vitest] The vi.fn() mock did not use 'function' or 'class' in its implementation, see https://vitest.dev/api/vi#vi-spyon for examples.

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Could not create database from schema.sql: TypeError: Body is unusable: Body has already been read
[90m    at consumeBody (node:internal/deps/undici/undici:6223:15)[39m
[90m    at _Response.text (node:internal/deps/undici/undici:6175:18)[39m
    at SqliteService.tryLoadSchemaDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:351:43[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:187:22[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Could not load prebuilt database, trying schema.sql

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Could not create database from schema.sql: TypeError: Body is unusable: Body has already been read
[90m    at consumeBody (node:internal/deps/undici/undici:6223:15)[39m
[90m    at _Response.text (node:internal/deps/undici/undici:6175:18)[39m
    at SqliteService.tryLoadSchemaDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:351:43[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:187:22[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Could not load prebuilt database, trying schema.sql

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Could not create database from schema.sql: TypeError: Body is unusable: Body has already been read
[90m    at consumeBody (node:internal/deps/undici/undici:6223:15)[39m
[90m    at _Response.text (node:internal/deps/undici/undici:6175:18)[39m
    at SqliteService.tryLoadSchemaDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:351:43[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:187:22[90m)[39m

[90mstdout[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Current DB Schema Version: 0
[SqliteService] Applying migration v1: add_maintenance_and_location
[SqliteService] applied 1 migrations successfully.
[SqliteService] Definition catalogs already populated (1 resources, 1 machines)
[SqliteService] Assets already exist, skipping default seeding
[SqliteService] Database initialized with 1 tables

[90mstderr[2m | src/app/core/services/sqlite.service.spec.ts[2m > [22m[2mSqliteService[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[SqliteService] Failed to add column machines.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:251:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.maintenance_enabled TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:252:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.maintenance_schedule_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:253:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column machines.last_maintenance_json TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:254:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m
[SqliteService] Failed to add column resources.location_label TypeError: Cannot read properties of undefined (reading 'values')
    at SqliteService.safeAddColumn [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:294:36[90m)[39m
    at Object.run [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:255:30[90m)[39m
    at SqliteService.checkAndMigrate [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:268:27[90m)[39m
    at SqliteService.initDb [90m(/Users/mar/Projects/pylabpraxis/praxis/web-client/[39msrc/app/core/services/sqlite.service.ts:196:18[90m)[39m
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at listOnTimeout (node:internal/timers:569:9)[39m
[90m    at processTimers (node:internal/timers:543:7)[39m

 [31m❯[39m src/app/core/services/sqlite.service.spec.ts [2m([22m[2m13 tests[22m[2m | [22m[31m7 failed[39m[2m)[22m[33m 10336[2mms[22m[39m
     [32m✓[39m should be created[32m 48[2mms[22m[39m
     [32m✓[39m should initialize from prebuilt database if available[32m 39[2mms[22m[39m
[31m     [31m×[31m should fall back to schema.sql if prebuilt fails[39m[33m 5052[2mms[22m[39m
     [32m✓[39m should fall back to legacy if both prebuilt and schema fail[32m 52[2mms[22m[39m
     [32m✓[39m should load from IndexedDB persistence if available[32m 24[2mms[22m[39m
[31m     [31m×[31m should save to IndexedDB on request[39m[32m 34[2mms[22m[39m
     [32m✓[39m should clear store on clearStore[32m 9[2mms[22m[39m
[31m     [31m×[31m should create a machine and persist[39m[32m 11[2mms[22m[39m
     [32m✓[39m should list protocols from both new and legacy tables[32m 8[2mms[22m[39m
[31m     [31m×[31m should get protocol simulation data[39m[32m 8[2mms[22m[39m
[31m     [31m×[31m should export database to file[39m[32m 6[2mms[22m[39m
[31m     [31m×[31m should import database from file[39m[32m 3[2mms[22m[39m
[31m     [31m×[31m should handle initialization errors gracefully[39m[33m 5038[2mms[22m[39m

[31m⎯⎯⎯⎯⎯⎯⎯[39m[1m[41m Failed Tests 7 [49m[22m[31m⎯⎯⎯⎯⎯⎯⎯[39m

[41m[1m FAIL [22m[49m src/app/core/services/sqlite.service.spec.ts[2m > [22mSqliteService[2m > [22mshould fall back to schema.sql if prebuilt fails
[31m[1mError[22m: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".[39m
[36m [2m❯[22m src/app/core/services/sqlite.service.spec.ts:[2m191:5[22m[39m
    [90m189| [39m    })[33m;[39m
    [90m190| [39m
    [90m191| [39m    it('should fall back to schema.sql if prebuilt fails', async () =>…
    [90m   | [39m    [31m^[39m
    [90m192| [39m        [90m// Setup IDB null[39m
    [90m193| [39m        mockIDBStore.get.mockReturnValue({ result: null, onsuccess: ()…

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯[22m[39m

[41m[1m FAIL [22m[49m src/app/core/services/sqlite.service.spec.ts[2m > [22mSqliteService[2m > [22mshould save to IndexedDB on request
[31m[1mTypeError[22m: Cannot read properties of null (reading 'export')[39m
[36m [2m❯[22m src/app/core/services/sqlite.service.spec.ts:[2m256:27[22m[39m
    [90m254| [39m        [34mexpect[39m(mockIDBStore[33m.[39mput)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m255| [39m        [35mconst[39m dbInstance [33m=[39m (service [35mas[39m any)[33m.[39mdbInstance[33m;[39m
    [90m256| [39m        [34mexpect[39m(dbInstance[33m.[39m[35mexport[39m)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m257| [39m    })[33m;[39m
    [90m258| [39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯[22m[39m

[41m[1m FAIL [22m[49m src/app/core/services/sqlite.service.spec.ts[2m > [22mSqliteService[2m > [22mshould create a machine and persist
[31m[1mTypeError[22m: defQuery.bind is not a function[39m
[36m [2m❯[22m src/app/core/services/sqlite.service.ts:[2m665:34[22m[39m
    [90m663| [39m                    [35mlet[39m defRow[33m:[39m any[] [33m|[39m [35mnull[39m [33m=[39m [35mnull[39m[33m;[39m
    [90m664| [39m                    [35mtry[39m {
    [90m665| [39m                        defQuery[33m.[39m[34mbind[39m([machine[33m.[39mplr_backend])[33m;[39m
    [90m   | [39m                                 [31m^[39m
    [90m666| [39m                        [35mif[39m (defQuery[33m.[39m[34mstep[39m()) {
    [90m667| [39m                            defRow [33m=[39m defQuery[33m.[39m[35mget[39m()[33m;[39m
[90m [2m❯[22m node_modules/rxjs/dist/cjs/internal/operators/map.js:[2m10:37[22m[39m
[90m [2m❯[22m OperatorSubscriber._this._next node_modules/rxjs/dist/cjs/internal/operators/OperatorSubscriber.js:[2m33:21[22m[39m
[90m [2m❯[22m OperatorSubscriber.Subscriber.next node_modules/rxjs/dist/cjs/internal/Subscriber.js:[2m51:18[22m[39m
[90m [2m❯[22m node_modules/rxjs/dist/cjs/internal/Subject.js:[2m69:34[22m[39m
[90m [2m❯[22m Object.errorContext node_modules/rxjs/dist/cjs/internal/util/errorContext.js:[2m22:9[22m[39m
[90m [2m❯[22m ReplaySubject.Subject.next node_modules/rxjs/dist/cjs/internal/Subject.js:[2m59:24[22m[39m
[90m [2m❯[22m ReplaySubject.next node_modules/rxjs/dist/cjs/internal/ReplaySubject.js:[2m45:31[22m[39m
[90m [2m❯[22m Object.next node_modules/rxjs/dist/cjs/internal/operators/share.js:[2m69:58[22m[39m
[90m [2m❯[22m ConsumerObserver.next node_modules/rxjs/dist/cjs/internal/Subscriber.js:[2m113:33[22m[39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯[22m[39m

[41m[1m FAIL [22m[49m src/app/core/services/sqlite.service.spec.ts[2m > [22mSqliteService[2m > [22mshould get protocol simulation data
[31m[1mTypeError[22m: Cannot read properties of null (reading 'exec')[39m
[36m [2m❯[22m src/app/core/services/sqlite.service.spec.ts:[2m312:12[22m[39m
    [90m310| [39m        [90m// Setup mock return for simulation data[39m
    [90m311| [39m        [35mconst[39m db [33m=[39m (service [35mas[39m any)[33m.[39mdbInstance[33m;[39m
    [90m312| [39m        db[33m.[39mexec[33m.[39m[34mmockImplementation[39m((sql[33m:[39m string) [33m=>[39m {
    [90m   | [39m           [31m^[39m
    [90m313| [39m            [35mif[39m (sql[33m.[39m[34mincludes[39m([32m'simulation_result_json'[39m)) {
    [90m314| [39m                [35mreturn[39m [{

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯[22m[39m

[41m[1m FAIL [22m[49m src/app/core/services/sqlite.service.spec.ts[2m > [22mSqliteService[2m > [22mshould export database to file
[31m[1mError[22m: Database not initialized[39m
[36m [2m❯[22m SqliteService.exportDatabase src/app/core/services/sqlite.service.ts:[2m1087:19[22m[39m
    [90m1085| [39m    [35mpublic[39m [35masync[39m [34mexportDatabase[39m()[33m:[39m [33mPromise[39m[33m<[39m[35mvoid[39m[33m>[39m {
    [90m1086| [39m        [35mif[39m ([33m![39m[35mthis[39m[33m.[39mdbInstance) {
    [90m1087| [39m            [35mthrow[39m [35mnew[39m [33mError[39m([32m'Database not initialized'[39m)[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m1088| [39m        }
    [90m1089| [39m
[90m [2m❯[22m src/app/core/services/sqlite.service.spec.ts:[2m343:23[22m[39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯[22m[39m

[41m[1m FAIL [22m[49m src/app/core/services/sqlite.service.spec.ts[2m > [22mSqliteService[2m > [22mshould import database from file
[31m[1mTypeError[22m: file.arrayBuffer is not a function[39m
[36m [2m❯[22m SqliteService.importDatabase src/app/core/services/sqlite.service.ts:[2m1106:35[22m[39m
    [90m1104| [39m     */[39m
    [90m1105| [39m    [35mpublic[39m [35masync[39m [34mimportDatabase[39m(file[33m:[39m [33mFile[39m)[33m:[39m [33mPromise[39m[33m<[39m[35mvoid[39m[33m>[39m {
    [90m1106| [39m        [35mconst[39m buffer [33m=[39m [35mawait[39m file[33m.[39m[34marrayBuffer[39m()[33m;[39m
    [90m   | [39m                                  [31m^[39m
    [90m1107| [39m        [35mconst[39m data [33m=[39m [35mnew[39m [33mUint8Array[39m(buffer)[33m;[39m
    [90m1108| [39m
[90m [2m❯[22m src/app/core/services/sqlite.service.spec.ts:[2m355:23[22m[39m
[90m [2m❯[22m new ZoneAwarePromise node_modules/zone.js/fesm2015/zone.js:[2m2221:23[22m[39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯[22m[39m

[41m[1m FAIL [22m[49m src/app/core/services/sqlite.service.spec.ts[2m > [22mSqliteService[2m > [22mshould handle initialization errors gracefully
[31m[1mError[22m: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".[39m
[36m [2m❯[22m src/app/core/services/sqlite.service.spec.ts:[2m365:5[22m[39m
    [90m363| [39m    [90m// --- Error Handling ---[39m
    [90m364| [39m
    [90m365| [39m    [34mit[39m([32m'should handle initialization errors gracefully'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m   | [39m    [31m^[39m
    [90m366| [39m        [90m// Force sql.js failure[39m
    [90m367| [39m        vi.mocked(mockSqlJsModule.Database).mockImplementationOnce(() …

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m7 failed[39m[22m[2m | [22m[1m[32m6 passed[39m[22m[90m (13)[39m
[2m   Start at [22m 13:28:38
[2m   Duration [22m 12.05s[2m (transform 424ms, setup 334ms, import 449ms, tests 10.34s, environment 697ms)[22m

