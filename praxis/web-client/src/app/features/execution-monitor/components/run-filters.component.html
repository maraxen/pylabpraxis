<div id="praxis-run-filters-container"
    class="filters-container p-4 rounded-xl border border-[var(--theme-border)] bg-surface-container mb-4">
    <!-- Status Filter -->
    <div class="filter-group">
        <label class="text-xs font-medium text-sys-text-secondary uppercase tracking-wide mb-2 block">Status</label>
        <mat-chip-listbox [multiple]="true" [(ngModel)]="selectedStatuses" (change)="onFilterChange()"
            aria-label="Filter by status">
            @for (status of allStatuses; track status) {
            <mat-chip-option [value]="status" [class]="getStatusChipClass(status)">
                {{ status }}
            </mat-chip-option>
            }
        </mat-chip-listbox>
    </div>

    <!-- Protocol Filter -->
    <div class="filter-group min-w-[200px]">
        <mat-form-field appearance="outline" class="w-full dense-field">
            <mat-label>Protocol</mat-label>
            <mat-select [multiple]="true" [(ngModel)]="selectedProtocolIds" (selectionChange)="onFilterChange()"
                placeholder="All protocols">
                @for (protocol of protocols(); track protocol.accession_id) {
                <mat-option [value]="protocol.accession_id">
                    {{ protocol.name }}
                </mat-option>
                }
            </mat-select>
        </mat-form-field>
    </div>

    <!-- Sort By -->
    <div class="filter-group min-w-[160px]">
        <mat-form-field appearance="outline" class="w-full dense-field">
            <mat-label>Sort by</mat-label>
            <mat-select [(ngModel)]="sortBy" (selectionChange)="onFilterChange()">
                <mat-option value="created_at">Date Created</mat-option>
                <mat-option value="start_time">Start Time</mat-option>
                <mat-option value="status">Status</mat-option>
            </mat-select>
        </mat-form-field>
    </div>

    <!-- Sort Order Toggle -->
    <div class="filter-group">
        <label class="text-xs font-medium text-sys-text-secondary uppercase tracking-wide mb-2 block">Order</label>
        <mat-button-toggle-group hideSingleSelectionIndicator [(ngModel)]="sortOrder" (change)="onFilterChange()"
            aria-label="Sort order">
            <mat-button-toggle value="desc" aria-label="Newest first">
                <mat-icon>arrow_downward</mat-icon>
            </mat-button-toggle>
            <mat-button-toggle value="asc" aria-label="Oldest first">
                <mat-icon>arrow_upward</mat-icon>
            </mat-button-toggle>
        </mat-button-toggle-group>
    </div>

    <!-- Clear Filters -->
    @if (hasActiveFilters()) {
    <button mat-stroked-button (click)="clearFilters()" class="ml-auto" aria-label="Clear all filters">
        <mat-icon>filter_alt_off</mat-icon>
        Clear
    </button>
    }
</div>