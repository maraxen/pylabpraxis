:host {
    display: inline-block;
    outline: none;
}

.filter-chip {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 32px;
    padding: 0 12px;
    border-radius: 16px;
    border: 1px solid var(--theme-border);
    background-color: transparent;
    color: var(--theme-text-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    user-select: none;
    font-size: 13px;
    font-weight: 500;
    max-width: 250px;

    /* Text handling */
    .chip-text {
        margin-right: 4px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .chip-chevron {
        font-size: 18px;
        width: 18px;
        height: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0.7;
        flex-shrink: 0;
    }

    /* Hover State (Inactive) */
    &:hover:not(.disabled):not(.active) {
        background-color: var(--theme-surface-elevated);
        border-color: var(--theme-text-secondary);
    }

    /* Active State (Filled) */
    &.active {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
        color: #2b151a;
        /* Dark text for contrast against Rose Pompadour */

        .chip-chevron {
            opacity: 1;
        }

        &:hover:not(.disabled) {
            filter: brightness(1.1);
        }
    }

    /* Disabled State */
    &.disabled {
        cursor: not-allowed;
        border: 1px dashed var(--theme-border);
        background-color: var(--theme-surface);
        opacity: 0.5;

        /* We handle the shake separately via class */
    }

    /* Shake Animation Class */
    &.shake {
        animation: shake 0.3s cubic-bezier(.36, .07, .19, .97) both;
    }
}

/* Animation Keyframes */
@keyframes shake {

    10%,
    90% {
        transform: translate3d(-1px, 0, 0);
    }

    20%,
    80% {
        transform: translate3d(2px, 0, 0);
    }

    30%,
    50%,
    70% {
        transform: translate3d(-4px, 0, 0);
    }

    40%,
    60% {
        transform: translate3d(4px, 0, 0);
    }
}

/* Menu Customization helpers */
/* These styles might need to go in global styles if ViewEncapsulation is Emulated, 
   but mat-menu puts content in overlay which is outside component.
   So we can't style .filter-chip-menu here easily unless we turn off encapsulation or use ::ng-deep 
*/

::ng-deep .filter-chip-menu {
    .option-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        gap: 16px;
        min-width: 120px;
    }

    .option-count {
        font-size: 0.85em;
        opacity: 0.6;
    }
}